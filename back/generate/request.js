import Excel from 'exceljs'

//https://github.com/guyonroche/exceljs

export function generateExcel(req, res) {

        var workbook = new Excel.Workbook();
        var worksheet =  workbook.addWorksheet('sheet', {
                pageSetup: {paperSize: 9, orientation:'landscape'}
        });
        worksheet.columns = [
                { header: 'Id', key: 'id', width: 10 },
                { header: 'Name', key: 'name', width: 32 },
                { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }
        ];
        worksheet.addRow({id: 1, name: 'John Doe', dob: new Date(1970,1,1)});
        worksheet.addRow({id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});

        var myBase64Image = "data:image/png;base64,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";
        var imageId2 = workbook.addImage({
                base64: myBase64Image,
                extension: 'png',
        });

        worksheet.addImage(imageId2, 'B2:D6');

        workbook.xlsx.writeFile('./static/export.xlsx').then(function(data) {
                // done
                console.log(data, 'data')
        });

        res.send(true);
    
}